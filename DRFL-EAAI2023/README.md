<h2 align="center">Dual-stream Representation Fusion Learning for
Accurate Medical Image Segmentation</h2>

 This repository contains the code for the paper  Dual-stream Representation Fusion Learning for
Accurate Medical Image Segmentation


## Getting Started

### Requirement

```bash 
pip install -r requirement.txt
```

### Prepare Dataset

Please divide the data set into train and test, where there are three files of images, masks and sr under each directory. The directory structure is similar to ./data.  The super-resolution images generated by https://github.com/uw-loci/demo_wsi_superres are placed under the sr directory.


### Train Model
```bash 
python train.py -config config.yml -name model_name -gpu_ids gpu_id
```
### Test Model

```bash 
python test.py -config config.yml -name model_name -gpu_ids gpu_id
```

You can use test_select.py to choose the best threshold:

```bash
python test_select.py -config config.yml -name model_name -gpu_ids gpu_id
```

## Citation
If you find the paper or code useful, please consider citing:
```
@article{XU2023106402,
title = {Dual-stream Representation Fusion Learning for accurate medical image segmentation},
journal = {Engineering Applications of Artificial Intelligence},
volume = {123},
pages = {106402},
year = {2023},
issn = {0952-1976},
doi = {https://doi.org/10.1016/j.engappai.2023.106402},
url = {https://www.sciencedirect.com/science/article/pii/S0952197623005869},
author = {Rongtao Xu and Changwei Wang and Shibiao Xu and Weiliang Meng and Xiaopeng Zhang},
}

```
